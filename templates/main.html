{% extends "base.html" %}

{% block title %}Main{% endblock title %}

{% block content %}
    <div class="jumbotron">
        <div class="container">
            <div class="row">
                <div class="col-sm-3">
                    <div>
                        <img id="ninja-logo" class="img-responsive" src="https://s30.postimg.org/6mdag8cip/ninja.png">
                    </div>
                </div>
                <div class="col-sm-9">
                    <h1 class="orbitron-font">Ninja Tech Forum</h1><br>
                    <p>The best tehnical forum!</p><br>
                    {% if user %}
                        {% if forum_subscriber %}
                            {% if not forum_subscriber.forum_subscription %}
                                <form action="/forum_subscription/{{ forum_subscriber.key.id() }}" method="post">
                                    <input type="hidden" name="csrf_token" value="{{csrf_token}}">
                                    <p>Subscribe to forum</p>
                                    <button class="btn btn-default">Here!</button>
                                </form>

                            {% else %}
                                <form action="/forum_unsubscribe/{{ forum_subscriber.key.id() }}" method="post">
                                    <input type="hidden" name="csrf_token" value="{{csrf_token}}">
                                    <p>Unsubscribe from forum</p>
                                    <button class="btn btn-default">Here!</button>
                                </form>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                </div>

            </div>
        </div>
    </div>

    <div class="light-grey-box"></div>

    <div class="topic_list_box" style="background-color:white;">
        <div class="container">
            <table id="topicTable" class="table">
                <thead>
                    <tr>
                      <th>Topic title:</th>
                      <th>Creator:</th>
                      <th>Created on:</th>
                      <th>Comments:</th>
                    </tr>
                </thead>
                <tbody class="topic_list_seznam">
                    {% for topic in topic_list %}
                        <tr class="clickable-row" data-href="/topic/{{ topic.key.id() }}">
                          <td>{{ topic.title[0:22] + "..." }}</td>
                          <td>{{ topic.author_email }}</td>
                          <td>{{ topic.created.strftime('%d.%m.%Y at %H:%M') }}</td>
                          <td>{{ topic.comment_sum }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
        </div>
    </div>

    <div class="light-grey-box-2 margin-grey-box"></div>


{% endblock content %}

{% block script %}

<!-- datatable -->
<link rel="stylesheet" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
<script src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){
    $("#topicTable").DataTable();
    $(".clickable-row").click(function() {
        window.location = $(this).data("href");
    });
});
</script>
{% endblock script %}
